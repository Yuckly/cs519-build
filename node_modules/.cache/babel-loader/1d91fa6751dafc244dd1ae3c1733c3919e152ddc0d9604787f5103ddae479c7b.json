{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jiasonghuang/Desktop/cs519_diagnostic/diagnostic-test-Yuckly/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jiasonghuang/Desktop/cs519_diagnostic/diagnostic-test-Yuckly/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jiasonghuang/Desktop/cs519_diagnostic/diagnostic-test-Yuckly/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// async and await were created partially with the help of GPT4. As well as some of the error checkings\nimport{useEffect,useState}from\"react\";import Grid from\"@mui/material/Unstable_Grid2\";import{MenuItem,Select,Typography}from\"@mui/material\";/**\n * You will find globals from this file useful!\n */import{MY_BU_ID,BASE_API_URL,GET_DEFAULT_HEADERS}from\"./globals\";import{GradeTable}from\"./components/GradeTable\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){// You will need to use more of these!\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),currClassId=_useState2[0],setCurrClassId=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),currClassTitle=_useState4[0],setCurrClassTitle=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),classTitlesId=_useState6[0],setClassTitlesId=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),studentList=_useState8[0],setStudentList=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),classAssignmentList=_useState10[0],setClassAssignmentList=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),grade=_useState12[0],setGrade=_useState12[1];/**\n   * This is JUST an example of how you might fetch some data(with a different API).\n   * As you might notice, this does not show up in your console right now.\n   * This is because the function isn't called by anything!\n   *\n   * You will need to lookup how to fetch data from an API using React.js\n   * Something you might want to look at is the useEffect hook.\n   *\n   * The useEffect hook will be useful for populating the data in the dropdown box.\n   * You will want to make sure that the effect is only called once at component mount.\n   *\n   * You will also need to explore the use of async/await.\n   *\n   */var fetchClasses=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,classes,transformedClasses;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(BASE_API_URL,\"/class/listBySemester/fall2022?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 3:res=_context.sent;if(res.ok){_context.next=6;break;}throw new Error(\"Error: \".concat(res.status));case 6:_context.next=8;return res.json();case 8:classes=_context.sent;transformedClasses=classes.map(function(item){return{classId:item.classId,title:item.title};});setClassTitlesId(transformedClasses);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.error(\"Failed to fetch class data:\",_context.t0);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,13]]);}));return function fetchClasses(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchClasses();},[]);useEffect(function(){if(currClassId){fetchStudentsAndGrades(currClassId);}},[currClassId]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!currClassId){_context2.next=3;break;}_context2.next=3;return fetchAssignments(currClassId);case 3:case\"end\":return _context2.stop();}},_callee2);}))();},[currClassId]);var fetchGrades=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(studentId,classId){var res,_grade;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"\".concat(BASE_API_URL,\"/student/listGrades/\").concat(studentId,\"/\").concat(classId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 3:res=_context3.sent;if(res.ok){_context3.next=6;break;}throw new Error(\"Error: \".concat(res.status));case 6:_context3.next=8;return res.json();case 8:_grade=_context3.sent;return _context3.abrupt(\"return\",_grade);case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](0);console.error(\"Failed to fetch student grade:\",_context3.t0);case 15:case\"end\":return _context3.stop();}},_callee3,null,[[0,12]]);}));return function fetchGrades(_x,_x2){return _ref3.apply(this,arguments);};}();var fetchStudentsAndGrades=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(classId){var response,students,studentDetailsPromises,studentsWithGrades,studentDetailsArray,gradesArray;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return fetch(\"\".concat(BASE_API_URL,\"/class/listStudents/\").concat(classId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 3:response=_context5.sent;if(response.ok){_context5.next=6;break;}throw new Error(\"Error: \".concat(response.status));case 6:_context5.next=8;return response.json();case 8:students=_context5.sent;studentDetailsPromises=students.map(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(studentId){var studentDetails,grades;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetchStudentDetails(studentId);case 2:studentDetails=_context4.sent;_context4.next=5;return fetchGrades(studentId,classId);case 5:grades=_context4.sent;return _context4.abrupt(\"return\",{studentDetails:studentDetails,grades:grades});case 7:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref5.apply(this,arguments);};}());_context5.next=12;return Promise.all(studentDetailsPromises);case 12:studentsWithGrades=_context5.sent;// Separate the student details and grades\nstudentDetailsArray=studentsWithGrades.map(function(item){return item.studentDetails;});gradesArray=studentsWithGrades.map(function(item){return item.grades;});setStudentList(studentDetailsArray);setGrade(gradesArray);_context5.next=22;break;case 19:_context5.prev=19;_context5.t0=_context5[\"catch\"](0);console.error(\"Failed to fetch students and their grades:\",_context5.t0);case 22:case\"end\":return _context5.stop();}},_callee5,null,[[0,19]]);}));return function fetchStudentsAndGrades(_x3){return _ref4.apply(this,arguments);};}();var fetchStudentDetails=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(studentId){var response,studentDetails;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return fetch(\"\".concat(BASE_API_URL,\"/student/GetById/\").concat(studentId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 3:response=_context6.sent;if(response.ok){_context6.next=6;break;}throw new Error(\"Error: \".concat(response.status));case 6:_context6.next=8;return response.json();case 8:studentDetails=_context6.sent;return _context6.abrupt(\"return\",studentDetails);case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](0);console.error(\"Failed to fetch student information:\",_context6.t0);return _context6.abrupt(\"return\",null);case 16:case\"end\":return _context6.stop();}},_callee6,null,[[0,12]]);}));return function fetchStudentDetails(_x5){return _ref6.apply(this,arguments);};}();var fetchAssignments=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(classId){var res,assignments;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return fetch(\"\".concat(BASE_API_URL,\"/class/listAssignments/\").concat(classId,\"?buid=\").concat(MY_BU_ID),{method:\"GET\",headers:GET_DEFAULT_HEADERS()});case 3:res=_context7.sent;if(res.ok){_context7.next=6;break;}throw new Error(\"Error: \".concat(res.status));case 6:_context7.next=8;return res.json();case 8:assignments=_context7.sent;setClassAssignmentList(assignments);_context7.next=15;break;case 12:_context7.prev=12;_context7.t0=_context7[\"catch\"](0);console.error(\"Failed to fetch class assignments:\",_context7.t0);case 15:case\"end\":return _context7.stop();}},_callee7,null,[[0,12]]);}));return function fetchAssignments(_x6){return _ref7.apply(this,arguments);};}();var handleClassChange=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(newClassId){var selectedClass;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:setCurrClassId(newClassId);selectedClass=classTitlesId.find(function(classItem){return classItem.classId===newClassId;});if(selectedClass){setCurrClassTitle(selectedClass.title);}_context8.prev=3;_context8.next=6;return fetchStudentsAndGrades(newClassId);case 6:_context8.next=11;break;case 8:_context8.prev=8;_context8.t0=_context8[\"catch\"](3);console.error(\"Failed to fetch students and their grades:\",_context8.t0);case 11:case\"end\":return _context8.stop();}},_callee8,null,[[3,8]]);}));return function handleClassChange(_x7){return _ref8.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{style:{width:\"100vw\",height:\"100vh\"},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,style:{padding:\"1rem\"},children:[/*#__PURE__*/_jsx(Grid,{xs:12,container:true,alignItems:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h2\",gutterBottom:true,children:\"Spark Assessment\"})}),/*#__PURE__*/_jsxs(Grid,{xs:12,md:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Select a class\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\"},children:/*#__PURE__*/_jsx(Select,{fullWidth:true,value:currClassId||\"\",onChange:function onChange(e){handleClassChange(e.target.value);},children:classTitlesId.map(function(classItem){return/*#__PURE__*/_jsx(MenuItem,{value:classItem.classId,children:classItem.title},classItem.classId);})})})]}),/*#__PURE__*/_jsxs(Grid,{xs:12,md:8,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Final Grades\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(GradeTable,{studentGrades:grade,studentDetails:studentList,classTitleId:[currClassTitle,currClassId],classAssignments:classAssignmentList})})]})]})});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}